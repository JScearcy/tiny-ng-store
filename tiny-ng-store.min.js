"use strict";var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},__decorate=this&&this.__decorate||function(t,e,r,n){var o,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(i<3?o(a):i>3?o(e,r,a):o(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},__metadata=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},core_1=require("@angular/core"),Observable_1=require("rxjs/Observable"),Subject_1=require("rxjs/Subject"),BehaviorSubject_1=require("rxjs/BehaviorSubject");require("rxjs/add/operator/scan"),require("rxjs/add/operator/map"),require("rxjs/add/operator/take"),require("rxjs/add/operator/distinctUntilChanged");var TnsState=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(Observable_1.Observable);exports.TnsState=TnsState;var StoreItem=function(){function t(){}return t}();exports.StoreItem=StoreItem;var AddItem=function(){function t(t){this.storeItem=t}return t}(),RemoveItem=function(){function t(t){this.storeItem=t}return t}(),UpdateItem=function(){function t(t){this.storeItem=t}return t}(),TinyNgStore=function(){function t(){this.dispatcher=new Subject_1.Subject,this.state=this.storeInit([],this.dispatcher)}return t.prototype.InsertItem=function(t){return this.dispatcher.next(new AddItem(t)),this.GetItem(t.name)},t.prototype.DeleteItem=function(t){this.dispatcher.next(new RemoveItem({name:t}))},t.prototype.UpdateItem=function(t){this.dispatcher.next(new UpdateItem(t))},t.prototype.GetItem=function(t){return this.state.map(function(e){return e.find(function(e){return e.name===t})}).distinctUntilChanged()},t.prototype.storeInit=function(t,e){var r=new BehaviorSubject_1.BehaviorSubject(t);return this.store(t,e).subscribe(function(t){return r.next(t)}),r},t.prototype.store=function(t,e){var r=this;return e.scan(function(t,e){switch(e.constructor){case AddItem:var n=t.filter(function(t){return e.storeItem.name!==t.name});return n.concat([e.storeItem]);case RemoveItem:return t.filter(function(t){return t.name!==e.storeItem.name});case UpdateItem:return t.map(function(t){return t.name!==e.storeItem.name?t:r.updateItem(e.storeItem)});default:return t}},t)},t.prototype.updateItem=function(t){var e={};return Object.keys(t).map(function(r){return e[r]=t[r]}),e},t=__decorate([core_1.Injectable(),__metadata("design:paramtypes",[])],t)}();exports.TinyNgStore=TinyNgStore;