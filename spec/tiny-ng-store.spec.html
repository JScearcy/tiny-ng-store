<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="content-type" content="test/html;charset=utf-8">
        <title>tiny-ng-store Tests</title>
        <link rel="stylesheet" href="/node_modules/jasmine-core/lib/jasmine-core/jasmine.css">
        <script src="/node_modules/zone.js/dist/zone.js"></script>
        <script src="/node_modules/reflect-metadata/Reflect.js"></script>
        <script src="/node_modules/jasmine-core/lib/jasmine-core/jasmine.js"></script>
        <script src="/node_modules/jasmine-core/lib/jasmine-core/jasmine-html.js"></script>
        <script src="/node_modules/jasmine-core/lib/jasmine-core/boot.js"></script>
        <script src="https://code.jquery.com/jquery-3.0.0.min.js" integrity="sha256-JmvOoLtYsmqlsWxa7mDSLMwa6dZ9rrIdtrrVYRnDRH0=" crossorigin="anonymous"></script>
    </head>
    <body>
        <script src="../node_modules/systemjs/dist/system.src.js"></script>
        <script>
            System.config({
                map: {
                    'tiny-ng-store': '../',
                    '@angular': '../node_modules/@angular',
                    'rxjs': '../node_modules/rxjs'
                },
                packages: {
                    'spec': { defaultExtension: 'js' },
                    '@angular/core': { main: 'index.js', defaultExtension: 'js' },
                    'rxjs': { defaultExtension: 'js' },
                    'tiny-ng-store': {defaultExtension: 'js'}
                }
            });
            System.import('tiny-ng-store.spec.js')
                .then(window.onload)
                .catch(console.error.bind(console));

            var myReporter = {
                jasmineStarted: function(suiteInfo) {
                    console.log('Running suite with ' + suiteInfo.totalSpecsDefined);
                },

                suiteStarted: function(result) {
                    console.log('Suite started: ' + result.description + ' whose full description is: ' + result.fullName);
                },

                specStarted: function(result) {
                    console.log('Spec started: ' + result.description + ' whose full description is: ' + result.fullName);
                },

                specDone: function(result) {
                    console.log('Spec: ' + result.description + ' was ' + result.status);
                    for(var i = 0; i < result.failedExpectations.length; i++) {
                        console.log('Failure: ' + result.failedExpectations[i].message);
                        console.log(result.failedExpectations[i].stack);
                    }
                    console.log(result.passedExpectations.length);
                },

                suiteDone: function(result) {
                    console.log('Suite: ' + result.description + ' was ' + result.status);
                    for(var i = 0; i < result.failedExpectations.length; i++) {
                        console.log('AfterAll ' + result.failedExpectations[i].message);
                        console.log(result.failedExpectations[i].stack);
                    }
                    $.ajax({
                        method: "POST",
                        url: "https://ci.appveyor.com/api/tests/batch",
                        data: [
                            {
                                "testName": "Test Test",
                                "testFramework": "Jasmine",
                                "fileName": "tiny-ng-store.js",
                                "outcome": "Passed",
                                "durationMilliseconds": "100",
                                "ErrorMessage": "",
                                "ErrorStackTrace": "".
                                "StdOut": "",
                                "StdErr": ""
                            }
                        ]
                    });
                },
                jasmineDone: function() {
                    console.log('Finished suite');
                }
            };
            
            jasmine.getEnv().addReporter(myReporter);
            jasmine.getEnv().execute();
        </script>
    </body>
</html>